<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AL9000 Project: fpsoc/driver/ps_driver/mmc/example/al_mmc_sdma_blocked.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AL9000 Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_76ac82f562da316b2309805d3956dd01.html">fpsoc</a></li><li class="navelem"><a class="el" href="dir_57d5b9b58f4b925378ff2c5e15cdb3b5.html">driver</a></li><li class="navelem"><a class="el" href="dir_a142bca7253ca5dd8b1ad96ffc0e37e7.html">ps_driver</a></li><li class="navelem"><a class="el" href="dir_58c605062765aa1cc2c5ff1e5122d7e3.html">mmc</a></li><li class="navelem"><a class="el" href="dir_338b13088f43e0d9db8b476e3dd157b6.html">example</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">al_mmc_sdma_blocked.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;malloc.h&gt;</code><br />
<code>#include &quot;<a class="el" href="al__mmc__hal_8h_source.html">al_mmc_hal.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for al_mmc_sdma_blocked.c:</div>
<div class="dyncontent">
<div class="center"><img src="al__mmc__sdma__blocked_8c__incl.png" border="0" usemap="#fpsoc_2driver_2ps__driver_2mmc_2example_2al__mmc__sdma__blocked_8c" alt=""/></div>
<map name="fpsoc_2driver_2ps__driver_2mmc_2example_2al__mmc__sdma__blocked_8c" id="fpsoc_2driver_2ps__driver_2mmc_2example_2al__mmc__sdma__blocked_8c">
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0b85963cace75e76ae726bcffb04eb70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#a0b85963cace75e76ae726bcffb04eb70">DEVICE_ID</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:a0b85963cace75e76ae726bcffb04eb70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb2eb85f013a5e3015dcf9989360cbe6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#acb2eb85f013a5e3015dcf9989360cbe6">AL_MMC_EX_DEVICE_ID</a>&#160;&#160;&#160;(<a class="el" href="al__mmc__sdma__blocked_8c.html#a0b85963cace75e76ae726bcffb04eb70">DEVICE_ID</a>)</td></tr>
<tr class="separator:acb2eb85f013a5e3015dcf9989360cbe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a652169c9d8491daeab15d981692da99b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#a652169c9d8491daeab15d981692da99b">AL_MMC_EX_BLOCKED_TIMEOUT_IN_MS</a>&#160;&#160;&#160;(100)</td></tr>
<tr class="separator:a652169c9d8491daeab15d981692da99b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f32e3effd038d585fe52b438217646f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#a9f32e3effd038d585fe52b438217646f">AL_MMC_EX_BLOCK_SIZE</a>&#160;&#160;&#160;(512)</td></tr>
<tr class="separator:a9f32e3effd038d585fe52b438217646f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fc22be2075f7a1334278df37397c54"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#a88fc22be2075f7a1334278df37397c54">AL_MMC_EX_BLOCK_COUNT</a>&#160;&#160;&#160;(10)</td></tr>
<tr class="separator:a88fc22be2075f7a1334278df37397c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d52cfac5d835d6ca9ba884d7fffbe31"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#a5d52cfac5d835d6ca9ba884d7fffbe31">AL_MMC_EX_BLOCK_LEN</a>&#160;&#160;&#160;(<a class="el" href="al__mmc__sdma__blocked_8c.html#a9f32e3effd038d585fe52b438217646f">AL_MMC_EX_BLOCK_SIZE</a> * <a class="el" href="al__mmc__sdma__blocked_8c.html#a88fc22be2075f7a1334278df37397c54">AL_MMC_EX_BLOCK_COUNT</a>)</td></tr>
<tr class="separator:a5d52cfac5d835d6ca9ba884d7fffbe31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa452b1d2fe43334e02e0aa3fc41e84b2"><td class="memItemLeft" align="right" valign="top">static AL_S32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#aa452b1d2fe43334e02e0aa3fc41e84b2">AlMmc_Test_SdmaBlocked</a> (AL_VOID)</td></tr>
<tr class="separator:aa452b1d2fe43334e02e0aa3fc41e84b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7692d86a53d32e905d9d4b3dd8a1d19d"><td class="memItemLeft" align="right" valign="top">AL_S32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#a7692d86a53d32e905d9d4b3dd8a1d19d">main</a> (AL_VOID)</td></tr>
<tr class="separator:a7692d86a53d32e905d9d4b3dd8a1d19d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1947375a95cdfd392f8a659625bcab99"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structAL__MMC__InitStruct.html">AL_MMC_InitStruct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="al__mmc__sdma__blocked_8c.html#a1947375a95cdfd392f8a659625bcab99">MmcSdmaInit</a></td></tr>
<tr class="separator:a1947375a95cdfd392f8a659625bcab99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a88fc22be2075f7a1334278df37397c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88fc22be2075f7a1334278df37397c54">&#9670;&nbsp;</a></span>AL_MMC_EX_BLOCK_COUNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AL_MMC_EX_BLOCK_COUNT&#160;&#160;&#160;(10)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="al_mmc_sdma_blocked_8c-example.html#a10">al_mmc_sdma_blocked.c</a>.</dd>
</dl>
</div>
</div>
<a id="a5d52cfac5d835d6ca9ba884d7fffbe31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d52cfac5d835d6ca9ba884d7fffbe31">&#9670;&nbsp;</a></span>AL_MMC_EX_BLOCK_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AL_MMC_EX_BLOCK_LEN&#160;&#160;&#160;(<a class="el" href="al__mmc__sdma__blocked_8c.html#a9f32e3effd038d585fe52b438217646f">AL_MMC_EX_BLOCK_SIZE</a> * <a class="el" href="al__mmc__sdma__blocked_8c.html#a88fc22be2075f7a1334278df37397c54">AL_MMC_EX_BLOCK_COUNT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="al_mmc_sdma_blocked_8c-example.html#a12">al_mmc_sdma_blocked.c</a>.</dd>
</dl>
</div>
</div>
<a id="a9f32e3effd038d585fe52b438217646f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f32e3effd038d585fe52b438217646f">&#9670;&nbsp;</a></span>AL_MMC_EX_BLOCK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AL_MMC_EX_BLOCK_SIZE&#160;&#160;&#160;(512)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a652169c9d8491daeab15d981692da99b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a652169c9d8491daeab15d981692da99b">&#9670;&nbsp;</a></span>AL_MMC_EX_BLOCKED_TIMEOUT_IN_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AL_MMC_EX_BLOCKED_TIMEOUT_IN_MS&#160;&#160;&#160;(100)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="al_mmc_sdma_blocked_8c-example.html#a16">al_mmc_sdma_blocked.c</a>.</dd>
</dl>
</div>
</div>
<a id="acb2eb85f013a5e3015dcf9989360cbe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb2eb85f013a5e3015dcf9989360cbe6">&#9670;&nbsp;</a></span>AL_MMC_EX_DEVICE_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AL_MMC_EX_DEVICE_ID&#160;&#160;&#160;(<a class="el" href="al__mmc__sdma__blocked_8c.html#a0b85963cace75e76ae726bcffb04eb70">DEVICE_ID</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="al_mmc_sdma_blocked_8c-example.html#a14">al_mmc_sdma_blocked.c</a>.</dd>
</dl>
</div>
</div>
<a id="a0b85963cace75e76ae726bcffb04eb70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b85963cace75e76ae726bcffb04eb70">&#9670;&nbsp;</a></span>DEVICE_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEVICE_ID&#160;&#160;&#160;(0)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa452b1d2fe43334e02e0aa3fc41e84b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa452b1d2fe43334e02e0aa3fc41e84b2">&#9670;&nbsp;</a></span>AlMmc_Test_SdmaBlocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static AL_S32 AlMmc_Test_SdmaBlocked </td>
          <td>(</td>
          <td class="paramtype">AL_VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function tests the MMC device using SDMA in blocked mode. It allocates memory for write and read operations, initializes the MMC hardware, and performs write and read operations in a loop. Each loop iteration writes to and reads from the MMC device, compares the written and read data, and logs the result. If any operation fails, it logs an error message and returns an error code. The function also handles memory cleanup and cache flushing if MMU is enabled. The loop continues indefinitely, logging success messages for each successful data check.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns AL_OK on success, or an error code on failure. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="al_mmc_sdma_blocked_8c-example.html#a8">al_mmc_sdma_blocked.c</a>.</dd>
</dl>
</div>
</div>
<a id="a7692d86a53d32e905d9d4b3dd8a1d19d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7692d86a53d32e905d9d4b3dd8a1d19d">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AL_S32 main </td>
          <td>(</td>
          <td class="paramtype">AL_VOID&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function initializes the MMC test for SDMA in blocked mode. It logs the start of the test, calls the AlMmc_Test_SdmaBlocked function to perform the test, and logs the result. If the test fails, it logs an error message and returns the error code. Otherwise, it logs a success message indicating the test passed.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns AL_OK on success, or an error code on failure. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="al_mmc_sdma_blocked_8c-example.html#a9">al_mmc_sdma_blocked.c</a>.</dd>
</dl>
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1947375a95cdfd392f8a659625bcab99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1947375a95cdfd392f8a659625bcab99">&#9670;&nbsp;</a></span>MmcSdmaInit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structAL__MMC__InitStruct.html">AL_MMC_InitStruct</a> MmcSdmaInit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    .CardType           = <a class="code" href="al__mmc__dev_8h.html#af03c8c5c81a65b7c9a789f38eaacce08afa840c653459e5408c89455820d6b9fe">AL_MMC_CARD_TYPE_AUTO_DETECT</a>,</div><div class="line">    .DmaMode            = <a class="code" href="al__mmc__dev_8h.html#a9490e2aa4818015a9f2162480a0c22f3ae5590190b187f482cdec595a444d0ff6">AL_MMC_DMA_MODE_SDMA</a>,</div><div class="line">    .SpdMode            = <a class="code" href="al__mmc__dev_8h.html#a73585e2b48b96924e77982b7bafac307a6b9c86a2158843e19e38812b848435fc">AL_MMC_SPD_HS_SDR25</a>,</div><div class="line">    .BusWidth           = <a class="code" href="al__mmc__dev_8h.html#aca874cd4735b3ce642b9071eba1908f3a4267d6755cea2db8e0317efe8fb19da5">AL_MMC_BUS_WIDTH_4BIT</a>,</div><div class="line">    .Switch1v8          = AL_FUNC_DISABLE,</div><div class="line">    .AutoGenAdmaTblEn   = AL_FUNC_DISABLE,</div><div class="line">    .DmaBdary           = <a class="code" href="al__mmc__ll_8h.html#ace299a70ae004a82172f7528e97ecef3af957dfc8c9b4310335b9caf4c527524b">AL_MMC_BDARY_32K</a></div><div class="line">}</div><div class="ttc" id="al__mmc__dev_8h_html_aca874cd4735b3ce642b9071eba1908f3a4267d6755cea2db8e0317efe8fb19da5"><div class="ttname"><a href="al__mmc__dev_8h.html#aca874cd4735b3ce642b9071eba1908f3a4267d6755cea2db8e0317efe8fb19da5">AL_MMC_BUS_WIDTH_4BIT</a></div><div class="ttdef"><b>Definition:</b> al_mmc_dev.h:134</div></div>
<div class="ttc" id="al__mmc__dev_8h_html_af03c8c5c81a65b7c9a789f38eaacce08afa840c653459e5408c89455820d6b9fe"><div class="ttname"><a href="al__mmc__dev_8h.html#af03c8c5c81a65b7c9a789f38eaacce08afa840c653459e5408c89455820d6b9fe">AL_MMC_CARD_TYPE_AUTO_DETECT</a></div><div class="ttdef"><b>Definition:</b> al_mmc_dev.h:110</div></div>
<div class="ttc" id="al__mmc__dev_8h_html_a9490e2aa4818015a9f2162480a0c22f3ae5590190b187f482cdec595a444d0ff6"><div class="ttname"><a href="al__mmc__dev_8h.html#a9490e2aa4818015a9f2162480a0c22f3ae5590190b187f482cdec595a444d0ff6">AL_MMC_DMA_MODE_SDMA</a></div><div class="ttdef"><b>Definition:</b> al_mmc_dev.h:125</div></div>
<div class="ttc" id="al__mmc__dev_8h_html_a73585e2b48b96924e77982b7bafac307a6b9c86a2158843e19e38812b848435fc"><div class="ttname"><a href="al__mmc__dev_8h.html#a73585e2b48b96924e77982b7bafac307a6b9c86a2158843e19e38812b848435fc">AL_MMC_SPD_HS_SDR25</a></div><div class="ttdef"><b>Definition:</b> al_mmc_dev.h:141</div></div>
<div class="ttc" id="al__mmc__ll_8h_html_ace299a70ae004a82172f7528e97ecef3af957dfc8c9b4310335b9caf4c527524b"><div class="ttname"><a href="al__mmc__ll_8h.html#ace299a70ae004a82172f7528e97ecef3af957dfc8c9b4310335b9caf4c527524b">AL_MMC_BDARY_32K</a></div><div class="ttdef"><b>Definition:</b> al_mmc_ll.h:51</div></div>
</div><!-- fragment --><dl><dt><b>Examples: </b></dt><dd><a class="el" href="al_mmc_sdma_blocked_8c-example.html#a1">al_mmc_sdma_blocked.c</a>.</dd>
</dl>
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
