#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#include "../../../SoC/demosoc/Common/Include/demosoc_xec.h"
#include "nuclei_sdk_soc.h"

//#define BigLittleSwap16(A)        ((((uint16_t)(A) & 0xff00) >> 8) |                                                        (((uint16_t)(A) & 0x00ff) << 8))

//#define BigLittleSwap32(A)        ((((uint32_t)(A) & 0xff000000) >> 24) |                                                        (((uint32_t)(A) & 0x00ff0000) >> 8) |                                                        (((uint32_t)(A) & 0x0000ff00) << 8) |                                                        (((uint32_t)(A) & 0x000000ff) << 24))

uint8_t __attribute__((aligned(4))) buffer_arp[64] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, /* 以太网头部 目的地址 */
                                                      0x00, 0x2b, 0x20, 0x21, 0x03, 0x23, /* 以太网头部 源地址 */
                                                      0x08, 0x06,                         /* 以太网头部 IP数据报 */
                                                      0x00, 0x01,
                                                      0x08, 0x00, /* IP头总长度 单位长度4byte */
                                                      0x06,       /* IP头 TLL */
                                                      0x04,       /* IP头 协议IP */
                                                      0x00, 0x01, /* IP头 首部效验和 */
                                                      0x00, 0x2b, 0x20, 0x21, 0x03, 0x23,
                                                      0xc0, 0xa8, 0xC8, 0x02,
                                                      0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
                                                      0xc0, 0xa8, 0xC8, 0x05,
                                                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                                                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

#define BUFFER_UDP_LEN 152

uint8_t __attribute__((aligned(4))) buffer_udp[BUFFER_UDP_LEN] = {
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0x00, 0x2b, 0x20, 0x21, 0x03, 0x23,
    0x08, 0x00,
    0x45, 0x00, /* IP头部 IP协议版本为4 首部长度为5*4 区分服务区域不使用 */
    0x00, 0x58, /* IP头部 总长度 */
    0x12,
    0x34,
    0x40, 0x00,
    0xff,       /*IP头 TLL */
    0x11,       /*IP头 协议类型为UDP */
    0xe0, 0xb5, /*IP头 首部效验和 */
    0xc0, 0xa8, 0xc8, 0x02,
    0xff, 0xff, 0xff, 0xff,
    0x1f, 0x90, 0x1f, 0x90, 0x00, 0x44, 0x8d, 0xe2, 0x20, 0x4e, 0x75, 0x63, 0x6c, 0x65,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x30, 0x33, 0x32, 0x33, 0x0d, 0x0a};

uint8_t __attribute__((aligned(4))) buffer_udp1[40] = {
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0x01, 0x2b, 0x20, 0x21, 0x03, 0x23,
    0x08, 0x00, 0x45, 0x00,
    0x00, 0x58, 0x12, 0x34, 0x40, 0x00, 0xff, 0x11, 0xe0,
    0xb5, 0xc0, 0xa8, 0xd0, 0x47, 0x8f, 0xfe
    // 0xc8, 0x02, 0xff, 0xff
};

uint8_t __attribute__((aligned(4))) buffer_udp2[3072] = {
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, /*0x02, 0x2b, 0x20, 0x21, 0x03, 0x23, */ 0x08, 0x00, 0x45, 0x00,
    0x0b, 0xee, 0x00, 0x02, 0x00, 0x00, 0x80, 0xfd, 0xac, 0xb4, 0xc0, 0xa8, 0x00, 0x02, 0xc0, 0xa8,
    0x00, 0x0a, 0x1f, 0x90, 0x1f, 0x90, 0x00, 0x44, 0x8d, 0xe2, 0x20, 0x4e, 0x75, 0x63, 0x6c, 0x65,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x6f, 0x6c, 0x6c, 0x65, 0x72, 0x20, 0x0d, 0x0a, 0x54, 0x72, 0x61, 0x6e, 0x73, 0x6d, 0x69, 0x74,
    0x20, 0x53, 0x6d, 0x6f, 0x6b, 0x65, 0x20, 0x54, 0x65, 0x73, 0x74, 0x20, 0x32, 0x30, 0x32, 0x31,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x72,
    0x69, 0x20, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x43, 0x6f, 0x6e, 0x74, 0x11};

void XEC0_IRQHandler(void)
{
  XEC0_DMA_CH->DMA_CH0_Tx_Control = 0x0;
  FrameTypeDef frame;
  uint8_t *buffer;
  uint32_t length;
  uint32_t tempreg = 0;

  // if(ETH_Get_ITStatus(BIT(16)))
  //{
  //     ETH_Clear_ITStatus(BIT(16));
  tempreg = XEC0_DMA->DMA_Interrupt_Status; // F8041008
  // XEC0_DMA_CH->DMA_CH0_Rx_Control = 0x17ff8;

  XEC0_DMA_CH->DMA_CH0_Status = XEC0_DMA_CH->DMA_CH0_Status | 0x1 << 15 | 0x1 << 6;
  tempreg = XEC0_DMA->DMA_Interrupt_Status; // F8041008
  // XEC0_DMA_CH->DMA_CH0_Interrupt_Enable |= 0x1<<15 | 0x1<<6;
  frame = ETH_Rx_Packet();
  length = frame.length;
  buffer = (uint8_t *)frame.buffer;
  //  XEC0_DMA_CH->DMA_CH0_Rx_Control = 0x17ff8;
  for (int i = 0; i < 10; i++) //
  {
    // if(buffer_udp[i] !=  buffer[i] )
    //  {
    //   	printf("i=%x\r\n",i);
    //   	printf("frame_length=%x\r\n",frame.length);

    printf("buffer=%x\r\n", buffer[i]);
    //  }
    //	 printf("buffer=%4x\r\n",buffer[i]);
  }
  //   printf("XEC0 PHY ### pass ### \r\n");
  //  XEC0_DMA_CH->DMA_CH0_Tx_Control=	XEC0_DMA_CH->DMA_CH0_Tx_Control | 0x1 | 0x1<<4;
}

void XEC1_IRQHandler(void)
{
  XEC1_DMA_CH->DMA_CH0_Tx_Control = 0x0;
  FrameTypeDef frame;
  uint8_t *buffer;
  uint32_t length;
  uint32_t tempreg = 0;

  tempreg = XEC1_DMA->DMA_Interrupt_Status; // F8041008
  XEC1_DMA_CH->DMA_CH0_Status = XEC1_DMA_CH->DMA_CH0_Status | 0x1 << 15 | 0x1 << 6;
  tempreg = XEC1_DMA->DMA_Interrupt_Status; // F8041008
  frame = ETH1_Rx_Packet();
  length = frame.length;
  buffer = (uint8_t *)frame.buffer;
#if 0
  printf("Rx length : %d buffer=\r\n", length);
  for (int i = 0; i < length; i++)
  {
    printf("0x%x, ", buffer[i]);
  }
  printf("\r\n");
#endif
#if 0
  printf("0x794:%d\r\n",*((uint32_t *)(XEC1_MAC_BASE+0x794)));
  printf("0x798:%d\r\n",*((uint32_t *)(XEC1_MAC_BASE+0x798)));
  printf("0x79c:%d\r\n",*((uint32_t *)(XEC1_MAC_BASE+0x79c)));

  printf("0x7a0:%d\r\n",*((uint32_t *)(XEC1_MAC_BASE+0x7a0)));
      
  printf("0x7c8:%d\r\n",*((uint32_t *)(XEC1_MAC_BASE+0x7c8)));
  printf("0x7e0:%d\r\n",*((uint32_t *)(XEC1_MAC_BASE+0x7e0)));
#endif
  XEC0_DMA_CH->DMA_CH0_Interrupt_Enable = (XEC0_DMA_CH->DMA_CH0_Interrupt_Enable | 0x1 << 15) & (0xffffffbf); // f8041134
  // XEC0_DMA_CH->DMA_CH0_Rx_Control = 0x17ff9;    //0xf804_1108
  // ian     printf("length:%d\r\n",length);
  printf("XEC1 PHY ### pass ### \r\n");
  XEC1_DMA_CH->DMA_CH0_Tx_Control = XEC1_DMA_CH->DMA_CH0_Tx_Control | 0x1 | 0x1 << 4;
}

extern uint8_t Rx_Buff[ETH_RXBUFNB][ETH_RX_BUF_SIZE] __attribute__((aligned(4))); /* Ethernet Receive Buffer */
extern uint8_t Tx_Buff[ETH_TXBUFNB][ETH_TX_BUF_SIZE] __attribute__((aligned(4))); /* Ethernet Transmit Buffer */

extern uint8_t Rx_Buff1[ETH_RXBUFNB][ETH_RX_BUF_SIZE] __attribute__((aligned(4))); /* Ethernet Receive Buffer */
extern uint8_t Tx_Buff1[ETH_TXBUFNB][ETH_TX_BUF_SIZE] __attribute__((aligned(4))); /* Ethernet Transmit Buffer */

#define PHY_ADDR 0x0

#if 0 // RAW
void main(void)
{
  int i = 0;
  uint32_t tempctrl = 0;

  printf("\r\n rtp_lwip_xec start \r\n");

  *(uint32_t *)(0xf8800140u) =0x321;//0x361;  //0X350 0x310 MII ,0x361 rgmii 1000Mbps,rgmii 100Mbps, 0x3a1,0x321  phase 180
  *(uint32_t *)(0xf8800144u) =0x321; //0x350 MII CLK 

  __enable_irq();

	ECLIC_Register_IRQ(XEC1_IRQn, ECLIC_NON_VECTOR_INTERRUPT,
	                                 ECLIC_LEVEL_TRIGGER, 1, 1,
	                                 XEC1_IRQHandler);

  ETH1_DMARxDescChainInit(); //设置10M 100M
  ETH1_DMATxDescChainInit(); //设置发送长度
  ETH1_Init(); //环回 loopback

  for(i=0;i<1;i++)   //ETH_TXBUFNB
  {
    //memcpy((uint8_t *)Tx_Buff1[i],(uint8_t *)buffer_udp2,BUFFER_UDP_LEN);     //crc and pading   3072
    memcpy((uint8_t *)Tx_Buff1[i], (uint8_t *)buffer_udp1, 40);
  }

  // ETH1_Tx_Packet(BUFFER_UDP_LEN);
  // ETH1_Tx_Packet(3072);   //jumbo pkt
  ETH1_Tx_Packet(BUFFER_UDP_LEN);     ////crc and pading

  while(1);
}
#endif

uint8_t emac_send(char *data, unsigned int FrameLength)
{
#if 1
  ETH1_MACTransmissionCmd(DISABLE);
  ETH1_MACReceptionCmd(DISABLE);

  ETH1_DMARxDescChainInit(); //设置10M 100M
  ETH1_DMATxDescChainInit(); //设置发送长度

  ETH1_Init(); //环回 loopback
#endif

  //printf("emac_send FrameLength : %d \r\n", FrameLength);
  memcpy((uint8_t *)Tx_Buff1[0], (uint8_t *)data, FrameLength);
#if 0
  printf("Tx length : %d buffer=\r\n", FrameLength);
  for (int i = 0; i < FrameLength; i++)
  {
    printf("0x%x, ", data[i]);
  }
  printf("\r\n");
#endif
  ETH1_Tx_Packet(FrameLength);
}

uint8_t __attribute__((aligned(4))) buffer_test[64] = {
    0x68, 0x63, 0x78, 0xff, 0xff, 0xff,
    0x01, 0x2b, 0x20, 0x21, 0x03, 0x23,
    0x08, 0x00,
    0x45,
    0x00,
    0x00, 0x40,
    0x12, 0x34,
    0x40, 0x00,
    0xff,
    0x11,
    0xe0, 0xb5, 0xc0, 0xa8, 0xd0, 0x47, 0x8f, 0xaa
    // 0xc8, 0x02, 0xff, 0xff
};

uint8_t __attribute__((aligned(4))) buffer_udp_hello[BUFFER_UDP_LEN] = 
{
//0x8c, 
0xff,
0xec, 0x4b, 0x7f, 0x79, 0x3a, 0x60, 0x12, 0x3c, 0x34, 0xd2, 0x37, 0x08, 0x00, 0x45, 0x00,
0x00, 0x32, 0x1f, 0x0a, 0x00, 0x00, 0x7f, 0x11, 0xdd, 0xe2, 0x0a, 0x08, 0x21, 0xbb, 0x0a, 0x08,
0x09, 0x04, 0x1f, 0x90, 0x1f, 0x90, 0x00, 0x1e, 0x31, 0xb0, 0x68, 0x65, 0x6c, 0x6c, 0x6f, 0x31,
0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x0d, 0x0a
};

#if 0 // test emac_send()
void main(void)
{
  printf("\r\n rtp_lwip_xec start !!! \r\n");

  *(uint32_t *)(0xf8800140u) =0x321;
  *(uint32_t *)(0xf8800144u) =0x321;

  __enable_irq();

  ECLIC_Register_IRQ(XEC1_IRQn, ECLIC_NON_VECTOR_INTERRUPT,
	                                 ECLIC_LEVEL_TRIGGER, 1, 1,
	                                 XEC1_IRQHandler);

  ETH1_DMARxDescChainInit(); //设置10M 100M
  ETH1_DMATxDescChainInit(); //设置发送长度

  ETH1_Init(); //环回 loopback

  emac_send(buffer_test, sizeof(buffer_test));

  while(1);
}
#endif

#if 1 // rtp_LwIP_mac

#include "Network.h"

void init(void)
{
  *(uint32_t *)(0xf8800140u) = 0x321;
  *(uint32_t *)(0xf8800144u) = 0x321;

  __enable_irq();

  ECLIC_Register_IRQ(XEC1_IRQn, ECLIC_NON_VECTOR_INTERRUPT,
                     ECLIC_LEVEL_TRIGGER, 1, 1,
                     XEC1_IRQHandler);

  ETH1_DMARxDescChainInit(); //设置10M 100M
  ETH1_DMATxDescChainInit(); //设置发送长度

  ETH1_Init(); //环回 loopback

  // emac_send(buffer_test, sizeof(buffer_test));

  // while(1);
}

void main(void)
{
  // mac_init();
  // phy_init();
  printf("\r\n RTPS_tream_loop init !!! \r\n");

  init();

  //emac_send(buffer_udp_hello, 64); //ok

  RTPS_tream_loop();
  

  printf("hello world !!! \r\n");
  while (1)
    ;
}

#endif
